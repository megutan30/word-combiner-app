<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>単語組み合わせアプリ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            text-align: center;
            padding: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .content {
            padding: 40px;
        }

        .mode-selector {
            background: linear-gradient(135deg, #a8e6cf, #88d8a3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .mode-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .mode-btn {
            background: white;
            border: 3px solid #88d8a3;
            color: #2d3436;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .mode-btn.active {
            background: #00b894;
            color: white;
            border-color: #00a085;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
        }

        .mode-btn:hover:not(.active) {
            background: #f8f9fa;
            transform: translateY(-1px);
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 3px solid #ff6b6b;
            padding-bottom: 10px;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .category-tab {
            background: #f1f2f6;
            border: 2px solid #ddd;
            color: #2d3436;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .category-tab.active {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border-color: #ff6b6b;
        }

        .category-tab:hover:not(.active) {
            background: #e8e9ea;
        }

        .input-mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .input-mode-btn {
            background: #f1f2f6;
            border: 2px solid #ddd;
            color: #2d3436;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 14px;
        }

        .input-mode-btn.active {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            border-color: #00b894;
        }

        .input-mode-btn:hover:not(.active) {
            background: #e8e9ea;
        }

        .bulk-input-section {
            margin-bottom: 20px;
        }

        .bulk-input {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s;
            margin-bottom: 10px;
        }

        .bulk-input:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .bulk-input-controls {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .clear-btn {
            background: linear-gradient(135deg, #636e72, #2d3436);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .clear-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(99, 110, 114, 0.3);
        }
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .word-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .word-input:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .add-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.3);
        }

        .word-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            min-height: 50px;
            padding: 15px;
            border: 2px dashed #ddd;
            border-radius: 10px;
            background: #f9f9f9;
        }

        .word-tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: fadeIn 0.3s;
        }

        .word-tag.category1 {
            background: linear-gradient(135deg, #ff7675, #e17055);
        }

        .word-tag.category2 {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
        }

        .word-tag .remove-btn {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .generate-btn {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            margin-bottom: 30px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 184, 148, 0.3);
        }

        .generate-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-section {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }

        .word-boxes {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .word-box {
            background: white;
            border: 3px solid #ff6b6b;
            border-radius: 15px;
            padding: 20px;
            min-width: 150px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .word-box.box1 {
            border-color: #ff7675;
        }

        .word-box.box2 {
            border-color: #6c5ce7;
        }

        .word-box:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }

        .word-box.active {
            border-color: #00b894;
            background: #e8f5f0;
        }

        .word-box .word-text {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .word-box .hint {
            font-size: 0.9em;
            color: #666;
        }

        .word-box .category-label {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            color: #666;
        }

        .dislike-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: rgba(255, 99, 71, 0.8);
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.7;
        }

        .dislike-btn:hover {
            background: rgba(255, 99, 71, 1);
            opacity: 1;
            transform: scale(1.1);
            box-shadow: 0 3px 10px rgba(255, 99, 71, 0.4);
        }

        .dislike-btn:active {
            transform: scale(0.95);
        }

        .replacement-panel {
            background: white;
            border: 2px solid #ddd;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            animation: slideDown 0.3s;
        }

        .replacement-words {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .replacement-word {
            background: #f1f2f6;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .replacement-word:hover {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }

        .excluded-words-section {
            background: #fff5f5;
            border: 2px solid #ffcccb;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .excluded-words-section h4 {
            color: #dc3545;
            margin-bottom: 10px;
        }

        .excluded-words-section p {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .excluded-words {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .excluded-word {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            border-radius: 10px;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .excluded-word:hover {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .excluded-word::after {
            content: "クリックで復活";
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        .excluded-word:hover::after {
            opacity: 1;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .empty-state {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 20px;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 600px) {
            .word-input-section {
                flex-direction: column;
            }
            
            .word-boxes {
                flex-direction: column;
                align-items: center;
            }
            
            .content {
                padding: 20px;
            }

            .mode-buttons {
                flex-direction: column;
                align-items: center;
            }

            .input-mode-selector {
                justify-content: center;
            }

            .category-tabs {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎲 単語組み合わせアプリ</h1>
            <p>単語を登録してランダムな組み合わせを楽しもう！</p>
        </div>
        
        <div class="content">
            <!-- モード選択 -->
            <div class="mode-selector">
                <h3>🎯 モード選択</h3>
                <p>単語の管理方法を選択してください</p>
                <div class="mode-buttons">
                    <button class="mode-btn active" onclick="setMode('mixed')">
                        🌈 ミックスモード<br>
                        <small>全ての単語から選択</small>
                    </button>
                    <button class="mode-btn" onclick="setMode('category')">
                        📂 カテゴリモード<br>
                        <small>ボックスごとに専用リスト</small>
                    </button>
                </div>
            </div>

            <div class="section">
                <h2>📝 単語を追加</h2>
                
                <!-- カテゴリタブ（カテゴリモードのみ表示） -->
                <div class="category-tabs hidden" id="categoryTabs">
                    <div class="category-tab active" onclick="setActiveCategory(1)" id="tab1">
                        📦 ボックス1の単語
                    </div>
                    <div class="category-tab" onclick="setActiveCategory(2)" id="tab2">
                        📦 ボックス2の単語
                    </div>
                </div>
                
                <!-- 単語追加方法の切り替え -->
                <div class="input-mode-selector">
                    <button class="input-mode-btn active" onclick="setInputMode('single')" id="singleModeBtn">
                        ✏️ 個別入力
                    </button>
                    <button class="input-mode-btn" onclick="setInputMode('bulk')" id="bulkModeBtn">
                        📝 まとめて入力
                    </button>
                </div>
                
                <!-- 個別入力モード -->
                <div class="word-input-section" id="singleInputSection">
                    <input type="text" class="word-input" id="wordInput" placeholder="単語を入力してください">
                    <button class="add-btn" onclick="addWord()">追加</button>
                </div>
                
                <!-- まとめて入力モード -->
                <div class="bulk-input-section hidden" id="bulkInputSection">
                    <textarea class="bulk-input" id="bulkInput" placeholder="複数の単語を入力してください（改行、カンマ、スペースで区切り）&#10;例：&#10;美しい&#10;強い, 賢い&#10;優しい 勇敢な"></textarea>
                    <div class="bulk-input-controls">
                        <button class="add-btn" onclick="addBulkWords()">まとめて追加</button>
                        <button class="clear-btn" onclick="clearBulkInput()">クリア</button>
                    </div>
                </div>
                
                <div class="word-list" id="wordList">
                    <div class="empty-state">まだ単語が登録されていません</div>
                </div>
            </div>
            
            <div class="section">
                <button class="generate-btn" id="generateBtn" onclick="generateRandomPair()" disabled>
                    🎯 ランダムな組み合わせを生成
                </button>
                
                <div class="result-section" id="resultSection" style="display: none;">
                    <h3>✨ 今日の組み合わせ</h3>
                    <div class="word-boxes" id="wordBoxes">
                        <div class="word-box box1" id="wordBox1" onclick="selectBox(1)">
                            <div class="category-label" id="label1">ボックス1</div>
                            <div class="word-text" id="word1">単語1</div>
                            <div class="hint">クリックして変更</div>
                            <button class="dislike-btn" onclick="event.stopPropagation(); dislikeWord(1)" title="この単語を除外">
                                👎
                            </button>
                        </div>
                        <div class="word-box box2" id="wordBox2" onclick="selectBox(2)">
                            <div class="category-label" id="label2">ボックス2</div>
                            <div class="word-text" id="word2">単語2</div>
                            <div class="hint">クリックして変更</div>
                            <button class="dislike-btn" onclick="event.stopPropagation(); dislikeWord(2)" title="この単語を除外">
                                👎
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="replacement-panel" id="replacementPanel" style="display: none;">
                    <h4>🔄 単語を選択してください</h4>
                    <div class="replacement-words" id="replacementWords"></div>
                </div>

                <!-- 除外された単語の管理 -->
                <div class="excluded-words-section" id="excludedWordsSection" style="display: none;">
                    <h4>🚫 除外された単語</h4>
                    <p>除外された単語はランダム生成に含まれません。クリックで復活できます。</p>
                    <div class="excluded-words" id="excludedWords"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentMode = 'mixed'; // 'mixed' or 'category'
        let activeCategory = 1; // 1 or 2 (for category mode)
        let inputMode = 'single'; // 'single' or 'bulk'
        
        // ミックスモード用
        let mixedWords = [];
        let excludedMixedWords = [];
        
        // カテゴリモード用
        let category1Words = [];
        let category2Words = [];
        let excludedCategory1Words = [];
        let excludedCategory2Words = [];
        
        let currentWord1 = '';
        let currentWord2 = '';
        let selectedBox = 0;

        // 初期単語を追加（詳細なゲーム構成要素）
        const initialMixedWords = [
            // 基本要素
            'HP', 'MP', 'ゲージ', '画面', 'コントローラー', 'オプション', 'タイトル', '判定', 'ディスプレイ', 'プレイヤー', 
            '移動', 'スティック', 'ボタン', 'ジャンル', 'ローグライク', '文字', '解像度', 'フォント', 'メニュー', 'インベントリ',
            
            // コア・システム要素
            'エンジン', 'フレームワーク', 'アーキテクチャ', 'プラットフォーム', 'OS', 'ハードウェア', 'CPU', 'GPU', 'メモリ', 'ストレージ', 
            '帯域幅', 'レイテンシ', 'サーバー', 'クライアント', 'ピアツーピア', 'フレームレート', 'V-Sync', 'レンダリング', '描画', '最適化',
            
            // 入力・操作系
            'キーバインド', 'ホットキー', 'ショートカット', 'マクロ', '入力遅延', '応答性', 'フィードバック', '振動', '感度調整', 'デッドゾーン', 
            '加速度', '減速', 'スムージング', '予測入力', 'キーボード', 'マウス', 'タッチ', 'ジェスチャー', '十字キー', 'アナログスティック',
            
            // UI・画面要素
            'ステータス', 'HUD', 'ミニマップ', 'アイコン', 'カーソル', 'ツールチップ', 'ダイアログ', 'ポップアップ', 'スライダー', 'チェックボックス', 
            'ヘッダー', 'フッター', 'サイドバー', 'ナビゲーションバー', 'タブ', 'アコーディオン', 'モーダル', 'オーバーレイ', 'ドロップダウン', 'コンテキストメニュー',
            
            // 表示・視覚要素
            'フレームバッファ', 'Zバッファ', 'アルファブレンド', 'マルチサンプリング', 'アンチエイリアス', 'ミップマップ', 'LOD', 'カリング', 'オクルージョン', 
            'ライトマップ', '反射', '屈折', 'シェーダー', 'テクスチャ', 'マテリアル', 'ライティング', '影', 'パーティクル', 'エフェクト', 'アニメーション',
            
            // ゲームプレイ・メカニクス
            'レベル', '経験値', 'スキル', 'アビリティ', 'クラス', 'ジョブ', 'パラメータ', '能力値', '攻撃力', '防御力', '素早さ', '魔力', '運', 
            'クリティカル', '回避', '命中', '耐性', 'ルール', '制約', '条件', 'バランス', '調整', 'テストプレイ', 'デバッグ', 'パフォーマンス',
            
            // 戦闘・アクション詳細
            '攻撃', '防御', '魔法', 'スキル発動', 'コンボ', '必殺技', 'ガード', '回復', 'バフ', 'デバフ', '状態異常', '毒', '麻痺', '眠り', '混乱',
            '先制攻撃', '追撃', '連撃', '反撃', '迎撃', '牽制', 'フェイント', '回り込み', '突進', '後退', '離脱', '包囲', '挟み撃ち', '奇襲', '待ち伏せ',
            
            // アイテム・装備詳細
            '武器', '防具', 'アクセサリー', '消耗品', '回復アイテム', '素材', '通貨', 'ゴールド', 'コイン', 'ジェム', 'ポーション', 'エリクサー', '鍵', '宝箱',
            'レアリティ', '品質', '耐久度', '重量', 'サイズ', 'スタック', '所持制限', 'エンチャント', '強化', '改造', '分解', '修理', '売却', '廃棄',
            
            // キャラクター・エンティティ
            '主人公', '仲間', 'NPC', '敵', 'ボス', '商人', 'ガイド', 'モンスター', 'ドラゴン', 'スライム', 'ゴブリン', 'エルフ', 'ドワーフ',
            'アバター', 'カスタマイゼーション', '外見', '服装', '髪型', '肌色', '身長', '体型', '性別', '年齢', '職業', '出身', '性格', '嗜好', '関係性',
            
            // 世界・環境詳細
            'ワールド', 'ステージ', 'フィールド', 'ダンジョン', '街', '村', '城', '塔', '洞窟', '森', '山', '海', '砂漠', '氷原', '火山', '空', '地下', '異世界',
            '地形', '高低差', '障害物', '隠し通路', '秘密エリア', 'ワープポイント', 'セーブポイント', '回復ポイント', 'ショップ', '宿屋', 'ギルド', '酒場', '教会',
            
            // ストーリー・世界観
            'シナリオ', '脚本', '台詞', 'ナレーション', 'モノローグ', '会話', '選択肢', '分岐', 'フラグ', 'イベント', 'カットイン', 'フラッシュバック', '伏線', 'どんでん返し',
            'クエスト', 'ミッション', '目標', 'チャレンジ', 'パズル', '謎解き', '探索', '収集', '育成', '合成', 'クラフト', '建築', '農業',
            
            // オーディオ詳細
            'BGM', 'SE', 'ボイス', '効果音', '音量', 'ミュート', 'グラフィック', '音響効果', '残響', 'エコー', 'ディストーション', 'フィルター', 
            'イコライザー', 'コンプレッサー', 'リバーブ', 'ディレイ', 'モジュレーション', 'サンプリング', 'シンセサイザー', 'サウンドトラック', 'テーマ曲',
            
            // 進行・セーブ詳細
            'セーブ', 'ロード', 'オートセーブ', 'チェックポイント', '進行度', 'クリア', 'ゲームオーバー', 'リスタート', 'コンティニュー', 'ニューゲーム', 
            '周回', 'エンディング', '変数', 'フラグ', '配列', 'オブジェクト', '構造体', 'クラス', '継承', 'ポリモーフィズム', 'シリアライゼーション',
            
            // ネットワーク詳細
            'オンライン', 'オフライン', 'マルチプレイ', '協力プレイ', '対戦', 'ランキング', 'リーダーボード', 'フレンド', 'ギルド', 'チャット', 'ボイスチャット',
            '接続', '切断', '再接続', '同期', '非同期', '予測', '補間', '補正', 'ロールバック', 'パケット', 'プロトコル', '暗号化', '認証', 'セッション',
            
            // AI・自動化
            '人工知能', '機械学習', '深層学習', '決定木', '状態機械', '行動木', 'ニューラルネットワーク', '遺伝的アルゴリズム', 'A*', 'ダイクストラ', 'パスファインディング',
            
            // 物理・シミュレーション
            '剛体', '軟体', '流体', '粒子', '衝突検出', '摩擦', '弾性', '粘性', '浮力', '風力', '磁力', '電力', '熱力', '音波', '光波', '重力', '物理法則',
            
            // ジャンル・システム
            'RPG', 'アクション', 'シューティング', 'パズルゲーム', 'シミュレーション', 'レーシング', '格闘', '音楽ゲーム', 'ホラー', 'アドベンチャー', 
            'ストラテジー', 'FPS', 'TPS', 'MMORPG', 'JRPG', 'RTS', 'MOBA', 'バトルロワイヤル', 'サンドボックス', 'メトロイドヴァニア'
        ];
        
        const initialCategory1Words = [
            // システム・技術系
            'HP', 'MP', 'ゲージ', 'ステータス', 'レベル', '経験値', 'スキル', '攻撃力', '防御力', '素早さ', '魔力', '運', 'クリティカル', '回避', '命中', '耐性',
            'エンジン', 'フレームワーク', 'CPU', 'GPU', 'メモリ', 'レンダリング', 'フレームレート', 'アルゴリズム', 'AI', '物理演算', 'シェーダー', 'テクスチャ',
            'バフ', 'デバフ', '状態異常', '毒', '麻痺', '眠り', '混乱', '能力値', 'パラメータ', 'アビリティ', 'クラス', 'ジョブ', '進行度', '難易度', '音量',
            'レアリティ', '品質', '耐久度', '重量', 'エンチャント', '強化', '改造', 'ネットワーク', '同期', '非同期', '予測', '補間', '暗号化', '認証'
        ];
        
        const initialCategory2Words = [
            // オブジェクト・場所・インターフェース系
            '画面', 'メニュー', 'インベントリ', 'HUD', 'ミニマップ', 'アイコン', 'カーソル', 'ツールチップ', 'ダイアログ', 'ポップアップ', 'スライダー', 'チェックボックス',
            'コントローラー', 'キーボード', 'マウス', 'スティック', 'ボタン', '十字キー', 'トリガー', 'ナビゲーションバー', 'タブ', 'モーダル', 'オーバーレイ', 'ドロップダウン',
            '武器', '防具', 'アクセサリー', '消耗品', '回復アイテム', '素材', '通貨', 'ポーション', 'エリクサー', '鍵', '宝箱', 'ワールド', 'ステージ', 'フィールド', 'ダンジョン',
            '街', '村', '城', '塔', '洞窟', '森', '山', '海', '砂漠', 'クエスト', 'ミッション', '目標', 'チャレンジ', 'パズル', '謎解き', '探索', '収集', '育成', '合成', 'クラフト',
            'セーブ', 'ロード', 'オートセーブ', 'チェックポイント', 'BGM', 'SE', 'エフェクト', 'アニメーション', 'パーティクル', 'キャラクター', 'NPC', 'ボス', 'モンスター'
        ];
        
        mixedWords = [...initialMixedWords];
        category1Words = [...initialCategory1Words];
        category2Words = [...initialCategory2Words];
        
        updateWordList();
        updateGenerateButton();
        updateExcludedWordsSection();

        function dislikeWord(boxNumber) {
            const wordToExclude = boxNumber === 1 ? currentWord1 : currentWord2;
            
            if (currentMode === 'mixed') {
                // ミックスモードでの除外
                mixedWords = mixedWords.filter(w => w !== wordToExclude);
                if (!excludedMixedWords.includes(wordToExclude)) {
                    excludedMixedWords.push(wordToExclude);
                }
            } else {
                // カテゴリモードでの除外
                if (boxNumber === 1) {
                    category1Words = category1Words.filter(w => w !== wordToExclude);
                    if (!excludedCategory1Words.includes(wordToExclude)) {
                        excludedCategory1Words.push(wordToExclude);
                    }
                } else {
                    category2Words = category2Words.filter(w => w !== wordToExclude);
                    if (!excludedCategory2Words.includes(wordToExclude)) {
                        excludedCategory2Words.push(wordToExclude);
                    }
                }
            }
            
            updateWordList();
            updateGenerateButton();
            updateExcludedWordsSection();
            updateExcludedWordsSection();
            
            // 新しい組み合わせを自動生成
            generateRandomPair();
            
            showNotification(`「${wordToExclude}」を除外しました`, 'warning');
        }

        function restoreWord(word) {
            if (currentMode === 'mixed') {
                excludedMixedWords = excludedMixedWords.filter(w => w !== word);
                if (!mixedWords.includes(word)) {
                    mixedWords.push(word);
                }
            } else {
                if (excludedCategory1Words.includes(word)) {
                    excludedCategory1Words = excludedCategory1Words.filter(w => w !== word);
                    if (!category1Words.includes(word)) {
                        category1Words.push(word);
                    }
                }
                if (excludedCategory2Words.includes(word)) {
                    excludedCategory2Words = excludedCategory2Words.filter(w => w !== word);
                    if (!category2Words.includes(word)) {
                        category2Words.push(word);
                    }
                }
            }
            
            updateWordList();
            updateGenerateButton();
            updateExcludedWordsSection();
            
            showNotification(`「${word}」を復活させました`, 'success');
        }

        function updateExcludedWordsSection() {
            const section = document.getElementById('excludedWordsSection');
            const container = document.getElementById('excludedWords');
            
            let excludedWords = [];
            if (currentMode === 'mixed') {
                excludedWords = excludedMixedWords;
            } else {
                excludedWords = [...excludedCategory1Words, ...excludedCategory2Words];
            }
            
            if (excludedWords.length === 0) {
                section.style.display = 'none';
                return;
            }
            
            section.style.display = 'block';
            container.innerHTML = excludedWords.map(word => `
                <div class="excluded-word" onclick="restoreWord('${word}')" title="クリックで復活">
                    ${word}
                </div>
            `).join('');
        }

        function setInputMode(mode) {
            inputMode = mode;
            
            // ボタンの状態を更新
            document.getElementById('singleModeBtn').classList.remove('active');
            document.getElementById('bulkModeBtn').classList.remove('active');
            document.getElementById(mode + 'ModeBtn').classList.add('active');
            
            // 入力エリアの表示/非表示
            const singleSection = document.getElementById('singleInputSection');
            const bulkSection = document.getElementById('bulkInputSection');
            
            if (mode === 'single') {
                singleSection.classList.remove('hidden');
                bulkSection.classList.add('hidden');
            } else {
                singleSection.classList.add('hidden');
                bulkSection.classList.remove('hidden');
            }
        }

        function parseBulkInput(text) {
            // 改行、カンマ、スペースで分割
            return text
                .split(/[\n,\s]+/)
                .map(word => word.trim())
                .filter(word => word.length > 0);
        }

        function addBulkWords() {
            const input = document.getElementById('bulkInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            const words = parseBulkInput(text);
            const currentWords = getCurrentWords();
            let addedCount = 0;
            
            words.forEach(word => {
                if (word && !currentWords.includes(word)) {
                    currentWords.push(word);
                    addedCount++;
                }
            });
            
            if (addedCount > 0) {
                input.value = '';
                updateWordList();
                updateGenerateButton();
                
                // 追加結果を表示
                showNotification(`${addedCount}個の単語を追加しました！`);
            } else {
                showNotification('追加できる新しい単語がありませんでした。', 'warning');
            }
        }

        function clearBulkInput() {
            document.getElementById('bulkInput').value = '';
        }

        function showNotification(message, type = 'success') {
            // 通知を表示する関数
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#00b894' : '#fdcb6e'};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideInRight 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            // 3秒後に自動削除
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // CSS アニメーションを動的に追加
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        function setMode(mode) {
            currentMode = mode;
            
            // ボタンの状態を更新
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // カテゴリタブの表示/非表示
            const categoryTabs = document.getElementById('categoryTabs');
            const label1 = document.getElementById('label1');
            const label2 = document.getElementById('label2');
            
            if (mode === 'category') {
                categoryTabs.classList.remove('hidden');
                label1.style.display = 'block';
                label2.style.display = 'block';
            } else {
                categoryTabs.classList.add('hidden');
                label1.style.display = 'none';
                label2.style.display = 'none';
            }
            
            updateWordList();
            updateGenerateButton();
            updateExcludedWordsSection();
            
            // 結果をリセット
            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('replacementPanel').style.display = 'none';
        }

        function setActiveCategory(category) {
            activeCategory = category;
            
            // タブの状態を更新
            document.getElementById('tab1').classList.remove('active');
            document.getElementById('tab2').classList.remove('active');
            document.getElementById(`tab${category}`).classList.add('active');
            
            updateWordList();
        }

        function getCurrentWords() {
            if (currentMode === 'mixed') {
                return mixedWords;
            } else {
                return activeCategory === 1 ? category1Words : category2Words;
            }
        }

        function addWord() {
            const input = document.getElementById('wordInput');
            const word = input.value.trim();
            const currentWords = getCurrentWords();
            
            if (word && !currentWords.includes(word)) {
                currentWords.push(word);
                input.value = '';
                updateWordList();
                updateGenerateButton();
            }
        }

        function removeWord(word) {
            if (currentMode === 'mixed') {
                mixedWords = mixedWords.filter(w => w !== word);
            } else {
                if (activeCategory === 1) {
                    category1Words = category1Words.filter(w => w !== word);
                } else {
                    category2Words = category2Words.filter(w => w !== word);
                }
            }
            updateWordList();
            updateGenerateButton();
            updateExcludedWordsSection();
        }

        function updateWordList() {
            const wordList = document.getElementById('wordList');
            const currentWords = getCurrentWords();
            
            if (currentWords.length === 0) {
                wordList.innerHTML = '<div class="empty-state">まだ単語が登録されていません</div>';
                return;
            }
            
            let categoryClass = '';
            if (currentMode === 'category') {
                categoryClass = activeCategory === 1 ? 'category1' : 'category2';
            }
            
            wordList.innerHTML = currentWords.map(word => `
                <div class="word-tag ${categoryClass}">
                    ${word}
                    <button class="remove-btn" onclick="removeWord('${word}')">×</button>
                </div>
            `).join('');
        }

        function updateGenerateButton() {
            const generateBtn = document.getElementById('generateBtn');
            
            if (currentMode === 'mixed') {
                generateBtn.disabled = mixedWords.length < 2;
            } else {
                generateBtn.disabled = category1Words.length === 0 || category2Words.length === 0;
            }
        }

        function generateRandomPair() {
            if (currentMode === 'mixed') {
                if (mixedWords.length < 2) return;
                const shuffled = [...mixedWords].sort(() => Math.random() - 0.5);
                currentWord1 = shuffled[0];
                currentWord2 = shuffled[1];
            } else {
                if (category1Words.length === 0 || category2Words.length === 0) return;
                currentWord1 = category1Words[Math.floor(Math.random() * category1Words.length)];
                currentWord2 = category2Words[Math.floor(Math.random() * category2Words.length)];
            }
            
            document.getElementById('word1').textContent = currentWord1;
            document.getElementById('word2').textContent = currentWord2;
            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('replacementPanel').style.display = 'none';
            
            // リセット選択状態
            document.getElementById('wordBox1').classList.remove('active');
            document.getElementById('wordBox2').classList.remove('active');
            selectedBox = 0;
        }

        function selectBox(boxNumber) {
            // 前の選択をリセット
            document.getElementById('wordBox1').classList.remove('active');
            document.getElementById('wordBox2').classList.remove('active');
            
            // 新しい選択を設定
            selectedBox = boxNumber;
            document.getElementById(`wordBox${boxNumber}`).classList.add('active');
            
            // 置換パネルを表示
            showReplacementPanel();
        }

        function showReplacementPanel() {
            const panel = document.getElementById('replacementPanel');
            const replacementWords = document.getElementById('replacementWords');
            
            let availableWords = [];
            const currentWord = selectedBox === 1 ? currentWord1 : currentWord2;
            
            if (currentMode === 'mixed') {
                availableWords = mixedWords.filter(word => word !== currentWord);
            } else {
                if (selectedBox === 1) {
                    availableWords = category1Words.filter(word => word !== currentWord);
                } else {
                    availableWords = category2Words.filter(word => word !== currentWord);
                }
            }
            
            replacementWords.innerHTML = availableWords.map(word => `
                <div class="replacement-word" onclick="replaceWord('${word}')">
                    ${word}
                </div>
            `).join('');
            
            panel.style.display = 'block';
        }

        function replaceWord(newWord) {
            if (selectedBox === 1) {
                currentWord1 = newWord;
                document.getElementById('word1').textContent = newWord;
            } else if (selectedBox === 2) {
                currentWord2 = newWord;
                document.getElementById('word2').textContent = newWord;
            }
            
            // パネルを隠す
            document.getElementById('replacementPanel').style.display = 'none';
            
            // 選択状態をリセット
            document.getElementById('wordBox1').classList.remove('active');
            document.getElementById('wordBox2').classList.remove('active');
            selectedBox = 0;
        }

        // Enterキーで単語を追加
        document.getElementById('wordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addWord();
            }
        });
    </script>
</body>
</html>
